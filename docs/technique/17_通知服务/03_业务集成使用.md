# 业务集成使用

使用中台的通知服务模块进行业务集成，可以使用已集成好的通知渠道。


通知服务集成

1、在通知平台注册应用获取 应用码 appCode ，在渠道配种中配置模块获取 渠道代码 channelId



2、项目添加POM依赖

<dependency>
    <groupId>com.alinesno.cloud.base.notice</groupId>
    <artifactId>alinesno-cloud-base-notice-api</artifactId>
    <version>${revision}</version>
</dependency>

3、 applicaiton.yaml添加参数

forest:
  variables:
    alinesno_notice_base_url: http://{url}
    
4、启动类添加注解
@ForestScan(basePackages = {"com.alinesno.cloud.base.notice.adapter"})


5、获取通知模板调用
AjaxResult template = templateAdapter.getTemplate(templateCode, appCode);


发送通知调用例子

@Autowired
private NoticesWebHookAdapter webHookAdapter;

public AjaxResult sendSms(String phone, String code) {

		
		// 构造短信参数参数
		JSONObject object = new JSONObject();
		object.put("code", code);
		

		// 获取模板内容并替换得到最终发送内容
		Map<String, Object> paramMap = new HashMap<String, Object>();
		paramMap.put("appCode", appCode);
		paramMap.put("channelId", channelId);
		paramMap.put("templateCode", registerTemplateCode);
		paramMap.put("phone", phone);
		paramMap.put("templateParam", object.toString());
		AjaxResult webhook = webHookAdapter.webhook(paramMap);
		return webhook;

}
  
  










